# UX Design: Ollama Integration for Content Generation

**Document Date**: January 5, 2026  
**Status**: Design Phase  
**Priority**: P1 - Core Feature

## Executive Summary

This document outlines the user experience design for integrating local Ollama model-based content generation alongside the existing copy-paste workflow. The design prioritizes **ease of use**, **seamless mode switching**, and **transparency** about generation methods and connection status.

---

## Design Principles

### 1. **Effortless Mode Switching**
Users should switch between copy-paste and Ollama generation with a single tap, no navigation required.

### 2. **Connection Transparency**
Always display connection status and available models without overwhelming the user.

### 3. **Graceful Fallback**
If Ollama becomes unavailable, suggest copy-paste mode without blocking workflows.

### 4. **Progressive Complexity**
Basic usage is instant; advanced configuration is discoverable but not mandatory.

### 5. **Accessibility First**
Large touch targets (48dp+), sufficient contrast, keyboard navigation support.

---

## User Flows

### Flow 1: New User - Initial Setup (Ollama Not Configured)

```
User Opens App
  â†“
Views Book Detail / Generate Content
  â†“
Sees "Copy-Paste Mode" as default
  â†“
Selects "Generate" button
  â†“
Two options appear:
  A) Paste from ChatGPT (default, blue)
  B) Use Local Ollama (secondary, gray - "Set Up First")
  â†“
User taps "Use Local Ollama"
  â†“
Navigates to Settings â†’ Ollama Configuration
  â†“
Sees Setup Wizard:
  - Enter Ollama URL (with suggestion: localhost:11434)
  - Test Connection
  - Select Model from dropdown
  - Save Settings
  â†“
Returns to Generate screen
  â†“
Ollama mode is now available
```

### Flow 2: Returning User - Quick Ollama Generation

```
User Views Book Detail
  â†“
Taps "Generate" button
  â†“
Sees mode selector:
  [ğŸ“‹ Paste from ChatGPT] [ğŸ¤– Ollama (Connected)]
  â†“
User taps Ollama button
  â†“
Shows loading state with spinner
  â†“
Displays streamed response as it arrives
  â†“
Shows "Generated by: llama3.2" credit
  â†“
User can Edit, Accept, or Regenerate
```

### Flow 3: Mode Switching During Session

```
User Generates with Ollama
  â†“
Result doesn't look right
  â†“
Taps "Try Different Method" button
  â†“
Modal appears: "Switch to Copy-Paste Mode?"
  â†“
User confirms
  â†“
Switches to paste input view
```

### Flow 4: Ollama Connection Lost

```
User Tries to Generate with Ollama
  â†“
Ollama unavailable (timeout)
  â†“
Error Dialog appears:
  - Icon: âš ï¸
  - Title: "Connection Lost"
  - Message: "Can't reach Ollama at [URL]"
  - Buttons: [Try Again] [Use Copy-Paste Instead]
  â†“
User taps "Use Copy-Paste Instead"
  â†“
Switches seamlessly to paste mode
```

---

## Information Architecture

### Current Screens (No Changes to Navigation)

```
Library Screen
â”œâ”€â”€ Settings (new section added)
â”‚   â””â”€â”€ Ollama Configuration
â”‚       â”œâ”€â”€ Connection Status
â”‚       â”œâ”€â”€ URL Configuration
â”‚       â”œâ”€â”€ Model Selection
â”‚       â””â”€â”€ Test Connection
â”œâ”€â”€ Book Detail Screen (unchanged)
â””â”€â”€ Generate Content (enhanced with mode selector)
```

### New UI Components

1. **Mode Selector Widget** - Two-button toggle for generation method
2. **Connection Status Indicator** - Visual indicator in settings
3. **Model Dropdown** - Available models from Ollama
4. **Ollama Configuration Panel** - In settings

---

## Detailed Screen Designs

### 1. Generate Content Dialog - Enhanced

#### Option A: Expandable Mode Selector (Recommended)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Generate Content                    â”‚
â”‚                                     â”‚
â”‚ Choose generation method:           â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“‹ Paste from ChatGPT           â”‚ â”‚
â”‚ â”‚ Use your preferred AI assistant â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¤– Ollama (Connected)           â”‚ â”‚
â”‚ â”‚ Local generation - llama3.2      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ [GENERATE]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**States:**
- **Copy-Paste Mode:**
  - Title: "ğŸ“‹ Paste from ChatGPT"
  - Subtitle: "Use your preferred AI assistant"
  - Button color: Primary (blue)
  - Icon: Clipboard

- **Ollama Connected:**
  - Title: "ğŸ¤– Ollama (Connected)"
  - Subtitle: "Local generation - [model name]"
  - Button color: Primary (blue)
  - Icon: Robot/Gear
  - Badge: "READY"

- **Ollama Not Configured:**
  - Title: "ğŸ¤– Ollama (Not Set Up)"
  - Subtitle: "Go to Settings to configure"
  - Button color: Disabled gray
  - Icon: Robot/Gear with lock
  - Badge: "SET UP REQUIRED"

- **Ollama Offline:**
  - Title: "ğŸ¤– Ollama (Offline)"
  - Subtitle: "Can't connect to [URL]"
  - Button color: Warning/orange
  - Icon: Robot/Gear with warning triangle
  - Badge: "OFFLINE"

#### Option B: Toggle Button (Alternative - More Compact)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Generate Content                    â”‚
â”‚                                     â”‚
â”‚ Generation method:                  â”‚
â”‚ [ğŸ“‹ Paste] [ğŸ¤– Ollama]              â”‚
â”‚ (toggle style, selected highlighted)â”‚
â”‚                                     â”‚
â”‚ Current selection details:          â”‚
â”‚ "Ollama - Using llama3.2"           â”‚
â”‚                                     â”‚
â”‚ [GENERATE]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Recommendation:** Use **Option A** for clarity; users can clearly see both options and their current status.

---

### 2. Ollama Settings Screen (New Section)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Settings                      â‡¦ Back â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Writing Preferences                 â”‚
â”‚ â”œâ”€ Writing Style                    â”‚
â”‚ â”œâ”€ Content Language                 â”‚
â”‚ â”œâ”€ Tone                             â”‚
â”‚ â”œâ”€ Vocabulary Level                 â”‚
â”‚ â””â”€ Favorite Author                  â”‚
â”‚                                     â”‚
â”‚ Ollama Configuration (NEW)          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Connection Status:              â”‚ â”‚
â”‚ â”‚ ğŸŸ¢ Connected to localhost:11434 â”‚ â”‚
â”‚ â”‚    Last checked: 2 min ago       â”‚ â”‚
â”‚ â”‚ [Refresh]                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Ollama Server URL               â”‚ â”‚
â”‚ â”‚ [http://localhost:11434       ] â”‚ â”‚
â”‚ â”‚ Tip: Include port number        â”‚ â”‚
â”‚ â”‚ [Test Connection]               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Model Selection                 â”‚ â”‚
â”‚ â”‚ Current: llama3.2               â”‚ â”‚
â”‚ â”‚ Available models:               â”‚ â”‚
â”‚ â”‚ â”œâ”€ llama3.2 (11B) âœ“             â”‚ â”‚
â”‚ â”‚ â”œâ”€ qwen2.5 (7B)                 â”‚ â”‚
â”‚ â”‚ â”œâ”€ mistral (7B)                 â”‚ â”‚
â”‚ â”‚ â””â”€ phi4 (14B)                   â”‚ â”‚
â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚ [Manage Models (pulls new ones)]â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ [Disconnect from Ollama]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Elements:**

1. **Connection Status Panel**
   - Status indicator (green circle = connected, red = offline, yellow = untested)
   - URL currently connected to
   - Last check timestamp
   - Refresh button for manual check

2. **Server Configuration**
   - URL input field with validation
   - Hint text with example
   - Test Connection button with loading state
   - Clear success/error messages

3. **Model Selection**
   - Dropdown/list of available models
   - Model size info (e.g., "llama3.2 (11B)")
   - Current selection highlighted
   - "Manage Models" link to Ollama web UI or pull new models

4. **Disconnect Option**
   - Button to switch back to copy-paste only mode
   - Confirmation dialog before disconnecting

---

### 3. Generation Screen - Loading State (Ollama)

#### When User Selects Ollama and Taps Generate:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ•                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Generating...                       â”‚
â”‚                                     â”‚
â”‚ ğŸ¤– Using llama3.2 (local)           â”‚
â”‚                                     â”‚
â”‚ âŸ³ Streaming response...             â”‚
â”‚                                     â”‚
â”‚ [Generated content will appear here] â”‚
â”‚                                     â”‚
â”‚ Thinking tokens: 142                â”‚
â”‚ Generated tokens: 856               â”‚
â”‚ Time: 8.2s                          â”‚
â”‚                                     â”‚
â”‚                    [Cancel Generation]
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**States During Generation:**
- Animated spinner with "Streaming response..."
- Real-time token count display (optional, for transparency)
- Time elapsed display
- Cancel button to stop generation
- Content streams in as it's generated

---

### 4. Generation Result - Credit Attribution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generated Content                   â”‚
â”‚                                     â”‚
â”‚ [Generated content here...]         â”‚
â”‚                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ¤– Generated by: llama3.2 (local)   â”‚
â”‚    Model size: 11B parameters       â”‚
â”‚    Generation time: 8.2s            â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                     â”‚
â”‚ [Edit] [âœ“ Accept] [â†» Regenerate]   â”‚
â”‚ [Try Different Method]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Important:** Always show:
- Model name used
- Generation time
- "Try Different Method" option (easy fallback)

---

### 5. Error States & Recovery

#### Connection Error - Graceful Fallback

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸  Connection Lost                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ Can't reach Ollama at               â”‚
â”‚ http://localhost:11434              â”‚
â”‚                                     â”‚
â”‚ Please check:                       â”‚
â”‚ â€¢ Ollama server is running          â”‚
â”‚ â€¢ Network connection is active      â”‚
â”‚ â€¢ URL is correct in settings        â”‚
â”‚                                     â”‚
â”‚ [Try Again] [Use Copy-Paste]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Model Not Available Error

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸  Model Not Found                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ The model "llama3.2" is not         â”‚
â”‚ currently available.                â”‚
â”‚                                     â”‚
â”‚ Available models:                   â”‚
â”‚ â€¢ qwen2.5                           â”‚
â”‚ â€¢ mistral                           â”‚
â”‚ â€¢ phi4                              â”‚
â”‚                                     â”‚
â”‚ [Select Different Model]            â”‚
â”‚ [Use Copy-Paste Instead]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Interaction Patterns

### 1. Mode Selection

**Primary Pattern:** Two-button choice modal
- Large, easily tappable buttons (56dp minimum height)
- Icons + text for clarity
- Status badge (Connected/Offline/Not Set Up)
- Keyboard navigation support (tab + enter)

### 2. Connection Testing

```
User taps [Test Connection]
  â†“
Button shows "Testing..." spinner
  â†“
Success: âœ“ "Connected successfully"
  â†“
Failure: âœ— "Connection failed: [error]"
  â†“
Auto-dismiss success after 2 seconds
  â†“
Let user fix on failure
```

### 3. Model Switching

```
User taps model dropdown
  â†“
Shows list of available models
  â†“
User selects new model
  â†“
Shows "Model switched to [name]"
  â†“
Next generation uses new model
```

---

## Accessibility Considerations

### Color Contrast
- Status indicators: Use color + icons (not color alone)
  - ğŸŸ¢ Connected (green + circle) / ğŸ”´ Offline (red + circle)
- Text: WCAG AA compliant (4.5:1 minimum)
- Links: Underlined or different styling, not color alone

### Touch Targets
- All buttons: Minimum 48dp height, 48dp width
- Mode selector buttons: 64dp height for easy tapping
- Dropdown menus: 56dp item height

### Semantic Labels
- Connection status: "Connected to Ollama at localhost:11434"
- Model dropdown: "Current model: llama3.2 (11B parameters)"
- Generate button: "Generate content using Ollama llama3.2"

### Keyboard Navigation
- Tab through all controls in logical order
- Enter/Space to activate buttons
- Arrow keys for dropdowns
- Escape to close dialogs

### Screen Reader Support
```dart
// Example for connection status
Semantics(
  label: 'Ollama connection status: Connected to localhost:11434',
  child: Row(
    children: [
      Icon(Icons.check_circle, color: Colors.green),
      Text('Connected to localhost:11434'),
    ],
  ),
)
```

---

## Visual Design Specifications

### Color Scheme
- **Primary (Active)**: Material 3 seedColor (deepOrange)
- **Connected Status**: Green (#4CAF50)
- **Offline Status**: Red (#F44336)
- **Testing State**: Amber (#FFC107)
- **Disabled State**: Gray (#BDBDBD)

### Icons
- **Copy-Paste Mode**: Icons.description (ğŸ“‹) or Icons.copy
- **Ollama Mode**: Icons.smart_toy or Icons.settings_suggest (ğŸ¤–)
- **Connection Status**: Icons.check_circle (âœ“), Icons.error (âœ—)
- **Ollama Offline**: Icons.cloud_off or Icons.signal_cellular_null

### Typography
- **Section Headers**: headline5, bold
- **Titles**: titleLarge, semi-bold
- **Body Text**: bodyMedium, regular
- **Status Text**: labelSmall, secondary color

### Spacing
- Container padding: 16dp (2x Material baseline grid)
- Between sections: 24dp
- Between buttons: 8dp
- Icon + text spacing: 12dp

---

## Implementation Guidelines

### State Management (Riverpod)

```
Providers needed:
â”œâ”€â”€ ollamaConfigProvider (read/write settings)
â”œâ”€â”€ ollamaConnectionStatusProvider (reactive connection check)
â”œâ”€â”€ ollamaModelsProvider (list available models)
â”œâ”€â”€ currentGenerationModeProvider (copy-paste vs ollama)
â”œâ”€â”€ generationProvider (handle both modes)
â””â”€â”€ ollamaGenerationStreamProvider (streaming responses)
```

### Error Handling

1. **No Ollama Configured**: Show setup wizard link in settings
2. **Ollama Unavailable**: Offer one-tap fallback to copy-paste
3. **Invalid URL**: Show validation error, suggest format
4. **Model Not Found**: Show available models, let user switch
5. **Timeout**: Show retry button with exponential backoff

### Loading States

- **Short Loading (< 1s)**: Show skeleton/placeholder
- **Medium Loading (1-3s)**: Show spinner with "Generating..."
- **Long Loading (> 3s)**: Show progress, token count, time elapsed
- **User Control**: Always show cancel button

---

## User Mental Models

### Before Ollama Integration
> "I generate content using ChatGPT, copy the response, and paste it here."

### After Ollama Integration
> "I can either paste from ChatGPT, or if I have Ollama running, I can generate locally with a single tap."

**Key Insight:** Ollama should feel like an *optional convenience*, not a required setup step.

---

## Migration Path

### Phase 1: Current State
- Copy-paste mode only
- Settings for writing preferences

### Phase 2: Ollama Support (This Design)
- Dual-mode generation (copy-paste + Ollama)
- Ollama settings in Settings screen
- Connection status visible
- Graceful fallback if offline

### Phase 3: Future Enhancements
- Save generation history
- Compare outputs from both modes
- Model quality ratings
- Batch generation
- Custom system prompts per generation type

---

## Testing Scenarios

### Happy Path
- âœ… User configures Ollama URL
- âœ… User selects model
- âœ… User generates content successfully
- âœ… Content appears in book

### Edge Cases
- âš ï¸ Ollama becomes offline mid-generation â†’ Cancel + fallback
- âš ï¸ User selects model that no longer exists â†’ Error + retry
- âš ï¸ Generation takes > 60 seconds â†’ Show timeout option
- âš ï¸ User configures invalid URL â†’ Validation error + hint

### Accessibility Testing
- âœ… All controls keyboard navigable
- âœ… Screen reader can read connection status
- âœ… Color-blind users can see status without color alone
- âœ… Text scaling to 200% doesn't break layout

---

## Success Metrics

1. **Setup Friction**: < 2 minutes from first Ollama config to first generation
2. **Mode Discovery**: 80%+ of users who have Ollama available try it within 5 interactions
3. **Error Recovery**: 90%+ of users successfully fall back to copy-paste on connection error
4. **User Satisfaction**: 4.5+ stars for "Easy to switch between generation methods"

---

## Related Documentation

- **Architecture**: See `ARCHITECTURE_OLLAMA_GENERATION.md`
- **API Integration**: See Ollama Toolkit README at `lib/ollama_toolkit/README.md`
- **Settings Models**: See `lib/features/settings/domain/app_settings.dart`

---

## Appendix: Wireframe Breakdown

### Simple ASCII Wireframes for Quick Reference

**Mode Selector Button Bar:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ Paste (56dp)  â”‚ ğŸ¤– Ollama (56dp) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  (12dp spacing between)
```

**Settings Configuration Block:**
```
â”Œâ”€ Ollama Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚ Status: ğŸŸ¢ Connected               â”‚
â”‚ URL: [__________ localhost:11434] â”‚
â”‚ Model: [â–¼ llama3.2]               â”‚
â”‚                                    â”‚
â”‚ [Test Connection] [Disconnect]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Result Card:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Generated content...]              â”‚
â”‚                                     â”‚
â”‚ ğŸ¤– llama3.2 â€¢ 8.2s â€¢ 856 tokens    â”‚
â”‚                                     â”‚
â”‚ [Edit] [âœ“] [â†»] [Try Different]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Document Version:** 1.0  
**Last Updated:** January 5, 2026  
**Next Review:** After Phase 2 implementation
